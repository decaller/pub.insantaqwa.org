<!DOCTYPE html>
<html lang="en" data-theme="dim">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mobile Cards Experience</title>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Tailwind CSS & DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        /* Smooth scrolling behavior */
        html {
            scroll-behavior: smooth;
        }

        /* Ensure range thumb is large enough for touch */
        input[type=range]::-webkit-slider-thumb {
            height: 24px;
            width: 24px;
        }
    </style>
</head>
<body class="bg-base-300 h-screen overflow-hidden text-base-content">

    <div id="app" class="relative h-full w-full flex">

        <!-- Vertical Steps (Sidebar) -->
        <div class="w-10 h-full flex flex-col bg-base-200 z-20 shrink-0 border-r border-base-content/10">
            <!-- Scrollable Steps Container -->
            <div 
                ref="stepsContainer" 
                class="flex-1 overflow-y-auto no-scrollbar flex flex-col items-center py-[45vh] gap-3 scroll-smooth"
            >
                 <div 
                    v-for="(card, index) in cards" 
                    :key="card.id"
                    :id="'step-' + index"
                    @click="scrollToCard(index)"
                    class="transition-all duration-300 rounded-full flex items-center justify-center text-[10px] font-bold cursor-pointer shrink-0"
                    :class="{
                        'w-6 h-6 bg-primary text-primary-content scale-125 z-10 shadow-lg': currentCardIndex === index,
                        'w-2 h-2 bg-success hover:scale-150': card.filled && currentCardIndex !== index,
                        'w-2 h-2 bg-base-content/20 hover:scale-150 hover:bg-base-content/40': !card.filled && currentCardIndex !== index
                    }"
                 >
                    <span v-if="currentCardIndex === index">{{ card.id }}</span>
                 </div>
            </div>
            <!-- Progress Text (Fixed at bottom) -->
            <div class="h-8 shrink-0 flex items-center justify-center bg-base-200 text-[10px] font-mono border-t border-base-content/10">
                {{ currentCardIndex + 1 }}/{{ cards.length }}
            </div>
        </div>

        <!-- Main Card Scroll Container -->
        <!-- snap-y mandatory creates the Instagram/TikTok like feel -->
        <div 
            ref="scrollContainer"
            class="flex-1 h-full overflow-y-scroll snap-y snap-mandatory scroll-smooth no-scrollbar relative"
            @scroll="handleScroll"
        >
            <div class="pb-[30vh] pt-[15vh]"> <!-- Padding to allow snapping to center -->
                
                <div 
                    v-for="(card, index) in cards" 
                    :key="card.id"
                    :id="'card-' + index"
                    class="w-full snap-center flex justify-center items-center py-4 px-4 min-h-[80vh]"
                >
                    <!-- Card Component -->
                    <div class="card w-full max-w-sm bg-base-100 shadow-xl h-[70vh] flex flex-col overflow-hidden transition-transform duration-300"
                         :class="{'scale-100 opacity-100': currentCardIndex === index, 'scale-95 opacity-50 blur-[1px]': currentCardIndex !== index}">
                        
                        <!-- Image Area (Top) -->
                        <figure class="h-1/3 w-full relative shrink-0">
                            <img :src="`https://picsum.photos/seed/${card.id}/400/300`" alt="Card Image" class="w-full h-full object-cover" />
                            <div class="absolute top-2 right-2 badge badge-neutral font-mono">#{{ card.id }}</div>
                            <div class="absolute bottom-0 w-full bg-gradient-to-t from-base-100 to-transparent h-12"></div>
                        </figure>

                        <!-- Content Area (Middle & Bottom - Thumb Reach) -->
                        <div class="card-body p-5 flex flex-col justify-between h-2/3">
                            
                            <!-- Text Content -->
                            <div>
                                <h2 class="card-title text-xl mb-1">{{ card.title }}</h2>
                                <p class="text-sm opacity-70 leading-snug line-clamp-3">{{ card.description }}</p>
                            </div>

                            <!-- Interactive Zone (Thumb Reach) -->
                            <div class="mt-auto space-y-6">
                                
                                <!-- Range Slider -->
                                <div class="w-full">
                                    <div class="flex justify-between text-xs font-bold uppercase tracking-wider mb-2">
                                        <span>Value</span>
                                        <span :class="card.filled ? 'text-primary' : 'text-base-content/50'">{{ card.sliderValue }}%</span>
                                    </div>
                                    <input 
                                        type="range" 
                                        min="0" 
                                        max="100" 
                                        v-model="card.sliderValue" 
                                        @input="markFilled(index)"
                                        class="range range-primary range-sm w-full" 
                                    />
                                    <div class="w-full flex justify-between text-[10px] px-1 mt-1 opacity-50 font-mono">
                                        <span>|</span><span>|</span><span>|</span><span>|</span><span>|</span>
                                    </div>
                                </div>

                                <!-- Navigation Buttons -->
                                <div class="grid grid-cols-2 gap-4">
                                    <button 
                                        @click="scrollToCard(index - 1)" 
                                        class="btn btn-outline btn-sm"
                                        :disabled="index === 0"
                                    >
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-1">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
                                        </svg>
                                        Prev
                                    </button>
                                    
                                    <button 
                                        @click="scrollToCard(index + 1)" 
                                        class="btn btn-primary btn-sm text-white"
                                        v-if="index < cards.length - 1"
                                    >
                                        Next
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 ml-1">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                                        </svg>
                                    </button>
                                    <button 
                                        v-else
                                        class="btn btn-success btn-sm text-white"
                                    >
                                        Finish
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, onMounted, computed, nextTick, watch } = Vue;

        createApp({
            setup() {
                const cards = ref([]);
                const scrollContainer = ref(null);
                const stepsContainer = ref(null);
                const currentCardIndex = ref(0);

                // Initialize 70 cards
                const initCards = () => {
                    const titles = ["User Experience", "Visual Design", "Interaction", "Accessibility", "Performance", "Color Theory", "Typography"];
                    const descs = [
                        "Rate your satisfaction with the current responsiveness of the mobile layout.",
                        "How would you grade the clarity of the visual hierarchy presented here?",
                        "Is the interaction smooth and intuitive for your daily usage?",
                        "Does the contrast ratio meet your reading requirements comfortably?",
                        "How fast does the content load on your specific network connection?",
                        "Are the color palettes pleasing and appropriate for the context?",
                        "Is the text legible and spaced correctly for easy scanning?"
                    ];

                    for (let i = 1; i <= 70; i++) {
                        cards.value.push({
                            id: i,
                            title: titles[(i - 1) % titles.length] + ` #${i}`,
                            description: descs[(i - 1) % descs.length] + " Adjust the slider below to reflect your opinion.",
                            sliderValue: 50,
                            filled: false,
                            index: i - 1
                        });
                    }
                };

                // Watch active index to auto-scroll sidebar steps
                watch(currentCardIndex, (newIndex) => {
                    const stepEl = document.getElementById(`step-${newIndex}`);
                    if (stepEl && stepsContainer.value) {
                        stepEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                });

                // Helper to mark a card as interacted
                const markFilled = (index) => {
                    cards.value[index].filled = true;
                };

                // Scroll Logic
                const scrollToCard = (index) => {
                    if (index < 0 || index >= cards.value.length) return;
                    
                    const el = document.getElementById(`card-${index}`);
                    if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                };

                // Update active index based on scroll position
                const handleScroll = (e) => {
                    // We use IntersectionObserver logic manually or just checking offset
                    // But simpler here: find the element closest to center
                    const container = scrollContainer.value;
                    if(!container) return;

                    const containerCenter = container.scrollTop + (container.clientHeight / 2);
                    
                    // Simple heuristic: container.scrollTop / average card height, 
                    // but safer to find closest element center
                    
                    // Optimization: Check only nearby cards if list is huge, 
                    // but for 70 items, iterating positions is fine or use pure math if heights fixed.
                    // Since snap point is center, let's use math.
                    // However, IntersectionObserver is cleaner. Let's do a lightweight check.
                    
                    // We will use IntersectionObserver in onMounted instead of scroll event for performance
                };

                // Calculate visible steps for the sidebar (Window of +/- 5)
                // REMOVED visibleSteps computed property as we now scroll the sidebar

                onMounted(() => {
                    initCards();

                    // Set up Intersection Observer to update currentCardIndex
                    const options = {
                        root: scrollContainer.value,
                        threshold: 0.6 // Card must be 60% visible to be "active"
                    };

                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const index = parseInt(entry.target.id.split('-')[1]);
                                currentCardIndex.value = index;
                            }
                        });
                    }, options);

                    nextTick(() => {
                        cards.value.forEach((_, index) => {
                            const el = document.getElementById(`card-${index}`);
                            if (el) observer.observe(el);
                        });
                    });
                });

                return {
                    cards,
                    scrollContainer,
                    stepsContainer,
                    currentCardIndex,
                    scrollToCard,
                    handleScroll,
                    markFilled
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
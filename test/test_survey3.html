<!DOCTYPE html>
<html lang="en" data-theme="dim">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mobile Cards Experience</title>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Tailwind CSS & DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        /* Smooth scrolling behavior */
        html {
            scroll-behavior: smooth;
        }

        /* Ensure range thumb is large enough for touch */
        input[type=range]::-webkit-slider-thumb {
            height: 24px;
            width: 24px;
        }
    </style>
</head>
<body class="bg-base-300 h-screen overflow-hidden text-base-content">

    <div id="app" class="relative h-full w-full flex flex-col">
        
        <div class="flex-1 flex overflow-hidden relative pb-20"> <!-- Added padding-bottom for Dock space -->

            <!-- MICRO NAV: Vertical Sidebar (Current Set Questions) -->
            <div class="w-14 h-full flex flex-col items-center bg-base-200 z-20 shrink-0 border-r border-base-content/10 py-4 transition-all duration-300">
                
                <!-- Set Label removed -->

                <!-- Questions in Current Set -->
                <div class="flex-1 w-full flex flex-col items-center gap-2 overflow-y-auto no-scrollbar pt-4">
                    <div 
                        v-for="card in currentSetCards" 
                        :key="card.id"
                        @click="scrollToCard(card.index)"
                        class="transition-all duration-300 rounded-full flex items-center justify-center text-[10px] font-bold cursor-pointer shrink-0 relative"
                        :class="{
                            'w-8 h-8 bg-primary text-primary-content shadow-lg scale-110 z-10': currentCardIndex === card.index,
                            'w-6 h-6 bg-success text-success-content opacity-80': card.filled && currentCardIndex !== card.index,
                            'w-6 h-6 bg-base-300 text-base-content/30 hover:bg-base-content/50': !card.filled && currentCardIndex !== card.index
                        }"
                    >
                        <span>{{ card.id }}</span>
                        <!-- Tiny active dot indicator removed -->
                    </div>
                </div>

                <!-- Next Set Button (Sidebar Footer) -->
                <button 
                    v-if="currentSetIndex < totalSets - 1"
                    @click="nextSet"
                    class="mt-4 btn btn-circle btn-xs btn-ghost border border-base-content/20 opacity-50 hover:opacity-100"
                    title="Next Set"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                    </svg>
                </button>
            </div>

            <!-- Main Card Scroll Container -->
            <div 
                ref="scrollContainer"
                class="flex-1 h-full overflow-y-scroll snap-y snap-mandatory scroll-smooth no-scrollbar relative"
            >
                <div class="pb-[20vh] pt-[5vh]"> <!-- Padding to allow snapping -->
                    
                    <div 
                        v-for="(card, index) in cards" 
                        :key="card.id"
                        :id="'card-' + index"
                        class="w-full snap-center flex justify-center items-center py-4 px-4 min-h-[70vh]"
                    >
                        <!-- Card Component -->
                        <div class="card w-full max-w-sm bg-base-100 shadow-xl h-[65vh] flex flex-col overflow-hidden transition-transform duration-300"
                             :class="{'scale-100 opacity-100 ring-2 ring-primary/20': currentCardIndex === index, 'scale-95 opacity-50 blur-[1px] grayscale-[0.5]': currentCardIndex !== index}">
                            
                            <!-- Image Area -->
                            <figure class="h-1/3 w-full relative shrink-0">
                                <img :src="`https://picsum.photos/seed/${card.id}/400/300`" alt="Card Image" class="w-full h-full object-cover" />
                                <div class="absolute top-2 right-2 badge badge-neutral font-mono shadow-md">#{{ card.id }}</div>
                                <div class="absolute bottom-0 w-full bg-gradient-to-t from-base-100 to-transparent h-12"></div>
                            </figure>

                            <!-- Content Area -->
                            <div class="card-body p-5 flex flex-col justify-between h-2/3">
                                <div>
                                    <div class="flex justify-between items-start">
                                        <h2 class="card-title text-lg mb-1">{{ card.title }}</h2>
                                        <div class="badge badge-sm badge-ghost">{{ card.category }}</div>
                                    </div>
                                    <p class="text-xs opacity-70 leading-snug line-clamp-3 mt-1">{{ card.description }}</p>
                                </div>

                                <!-- Interactive Zone -->
                                <div class="mt-auto space-y-4">
                                    <div class="w-full bg-base-200 p-3 rounded-box">
                                        <div class="flex justify-between text-[10px] font-bold uppercase tracking-wider mb-2">
                                            <span>Score</span>
                                            <span :class="card.filled ? 'text-primary' : 'text-base-content/50'">{{ card.sliderValue }}%</span>
                                        </div>
                                        <input 
                                            type="range" 
                                            min="0" 
                                            max="100" 
                                            v-model="card.sliderValue" 
                                            @input="markFilled(index)"
                                            class="range range-primary range-xs w-full" 
                                        />
                                    </div>
                                    
                                    <div class="text-center text-[10px] opacity-30 italic">
                                        Swipe up for next
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- MACRO NAV: Bottom Dock (Sets / Chapters) -->
        <div class="bg-base-100/90 backdrop-blur-xl h-20 w-full absolute bottom-0 z-30 border-t border-base-content/10 shadow-[0_-5px_20px_rgba(0,0,0,0.1)] flex flex-col">
            
            <!-- Progress Info -->
            <div class="h-6 w-full flex justify-between px-4 items-center text-[10px] font-mono bg-base-200/50">
                <span class="opacity-60">Set Progress</span>
                <span class="font-bold text-primary">{{ currentSetProgress }}%</span>
            </div>
            
            <!-- Horizontal Sets Scroll -->
            <div 
                ref="setsContainer"
                class="flex-1 overflow-x-auto no-scrollbar flex items-center px-4 gap-4 scroll-smooth"
            >
                <div 
                    v-for="(set, index) in totalSets" 
                    :key="index"
                    @click="jumpToSet(index)"
                    class="flex flex-col items-center justify-center cursor-pointer transition-all duration-300 group min-w-[3.5rem]"
                >
                    <!-- Step Indicator -->
                    <div 
                        class="rounded-xl flex flex-col items-center justify-center transition-all duration-300 border-2"
                        :class="{
                            'w-14 h-10 bg-primary text-primary-content border-primary shadow-lg translate-y-[-4px]': currentSetIndex === index,
                            'w-10 h-8 bg-base-200 text-base-content/60 border-transparent hover:bg-base-300': currentSetIndex !== index
                        }"
                    >
                        <span class="text-xs font-bold leading-none">S{{ index + 1 }}</span>
                        <span class="text-[8px] opacity-70 leading-none mt-[1px]">{{ (index * 10) + 1 }}-{{ (index + 1) * 10 }}</span>
                    </div>
                    
                    <!-- Set Completion Dot -->
                    <div class="mt-1 h-1 w-8 rounded-full bg-base-300 overflow-hidden">
                        <div class="h-full bg-success transition-all duration-500" :style="{ width: getSetCompletion(index) + '%' }"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        const { createApp, ref, onMounted, computed, nextTick, watch } = Vue;

        createApp({
            setup() {
                const cards = ref([]);
                const scrollContainer = ref(null);
                const currentCardIndex = ref(0);
                const QUESTIONS_PER_SET = 10;
                const TOTAL_CARDS = 70;

                // Derived State
                const currentSetIndex = computed(() => Math.floor(currentCardIndex.value / QUESTIONS_PER_SET));
                const totalSets = computed(() => Math.ceil(TOTAL_CARDS / QUESTIONS_PER_SET));

                // Get only cards for the Sidebar (Current Set)
                const currentSetCards = computed(() => {
                    const start = currentSetIndex.value * QUESTIONS_PER_SET;
                    const end = start + QUESTIONS_PER_SET;
                    return cards.value.slice(start, end);
                });

                // Calculate % completion of the current set
                const currentSetProgress = computed(() => {
                    const setCards = currentSetCards.value;
                    const filledCount = setCards.filter(c => c.filled).length;
                    return Math.round((filledCount / setCards.length) * 100);
                });

                // Initialize 70 cards
                const initCards = () => {
                    const titles = ["User Experience", "Visual Design", "Interaction", "Accessibility", "Performance", "Color Theory", "Typography"];
                    const categories = ["Design", "UI", "UX", "A11y", "Tech", "Art", "Content"];
                    const descs = [
                        "Rate your satisfaction with the current responsiveness of the mobile layout.",
                        "How would you grade the clarity of the visual hierarchy presented here?",
                        "Is the interaction smooth and intuitive for your daily usage?",
                        "Does the contrast ratio meet your reading requirements comfortably?",
                        "How fast does the content load on your specific network connection?",
                        "Are the color palettes pleasing and appropriate for the context?",
                        "Is the text legible and spaced correctly for easy scanning?"
                    ];

                    for (let i = 1; i <= TOTAL_CARDS; i++) {
                        cards.value.push({
                            id: i,
                            index: i - 1,
                            title: titles[(i - 1) % titles.length],
                            category: categories[(i - 1) % categories.length],
                            description: descs[(i - 1) % descs.length],
                            sliderValue: 50,
                            filled: false
                        });
                    }
                };

                const markFilled = (index) => {
                    cards.value[index].filled = true;
                };

                const scrollToCard = (index) => {
                    if (index < 0 || index >= cards.value.length) return;
                    const el = document.getElementById(`card-${index}`);
                    if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                };

                const jumpToSet = (setIndex) => {
                    const targetCardIndex = setIndex * QUESTIONS_PER_SET;
                    scrollToCard(targetCardIndex);
                };

                const nextSet = () => {
                    const nextSetIdx = currentSetIndex.value + 1;
                    if (nextSetIdx < totalSets.value) {
                        jumpToSet(nextSetIdx);
                    }
                };

                // Helper for dock visualization
                const getSetCompletion = (setIndex) => {
                    const start = setIndex * QUESTIONS_PER_SET;
                    const subset = cards.value.slice(start, start + QUESTIONS_PER_SET);
                    if (subset.length === 0) return 0;
                    const filled = subset.filter(c => c.filled).length;
                    return (filled / subset.length) * 100;
                };

                onMounted(() => {
                    initCards();

                    const options = {
                        root: scrollContainer.value,
                        threshold: 0.6
                    };

                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const index = parseInt(entry.target.id.split('-')[1]);
                                currentCardIndex.value = index;
                            }
                        });
                    }, options);

                    nextTick(() => {
                        cards.value.forEach((_, index) => {
                            const el = document.getElementById(`card-${index}`);
                            if (el) observer.observe(el);
                        });
                    });
                });

                return {
                    cards,
                    scrollContainer,
                    currentCardIndex,
                    currentSetIndex,
                    totalSets,
                    currentSetCards,
                    currentSetProgress,
                    markFilled,
                    scrollToCard,
                    jumpToSet,
                    nextSet,
                    getSetCompletion
                };
            }
        }).mount('#app');
    </script>
</body>
</html>